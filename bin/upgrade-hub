#!/bin/bash
set -eu
cd
export PATH="$(ruby -e 'puts Gem.user_dir')/bin:$PATH"
echo "Old version:"
~/bin/hub version
echo
echo "Removing old version..."
rm -fv ~/bin/hub
echo
echo "Installing 'hub' gem (temporarily)..."
gem install --user-install --no-rdoc --no-ri hub
echo
echo "Generating standalone version of 'hub'..."
~/bin/hub hub standalone > ~/bin/hub-new
chmod 755 ~/bin/hub-new
echo
echo "Removing 'hub' gem..."
gem uninstall --user-install --executables hub
echo
echo "Renaming binary..."
mv -v ~/bin/hub-new ~/bin/hub
echo
echo "New version:"
~/bin/hub version
