#!/bin/bash

set -u

function usage
{
    echo "Usage: djm model ModelName" >&2
    exit 1
}

action=${1:-}

if [ "$action" = "model" ]; then
    model=${2:-}
    if [ -z "$model" ]; then
        usage
    elif [ -e "$model.php" ]; then
        echo "$model.php exists" >&2
        exit 2
    elif [ -e "$model" ]; then
        echo "$model exists" >&2
        exit 3
    else
        
        mkdir $model
        
        # Table
        cat > "$model.php" <<END
<?php

class App_${model} extends djmDbTable
{
    
    protected
        //\$_defaultSource = self::DEFAULT_DB,
        \$_rowClass = self::AUTO_CLASS,
        \$_rowsetClass = self::AUTO_CLASS,
        \$_selectClass = self::AUTO_CLASS;
    
}
END
        
        # Row
        cat > "$model/Row.php" <<END
<?php

class App_${model}_Row extends djmDbRow
{
    
    
    
}
END
        
        # Rowset
        cat > "$model/Rowset.php" <<END
<?php

class App_${model}_Rowset extends djmDbRowset
{
    
    
    
}
END
        
        # Select
        cat > "$model/Select.php" <<END
<?php

class App_${model}_Select extends djmDbSelect
{
    
    
    
}
END
        
    fi
else
    usage
fi
